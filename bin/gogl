#!/usr/bin/env node

"use strict";

var program = require('commander');
var path = require('path');
var colors = require('colors');

var gogl = require('../index');

var  searchEngine = 'google', //default is google
     terms = '';



program
  .version(require(path.join(__dirname, '..', 'package.json')).version)
  .usage('<command> [options]')
  .option('-e, --engine [value]', 'Search Engines: so, baidu, google');


//CLI directly

program
  .command('so')
  .description('Search With www.so.com')
  .action(function(){
    searchEngine = 'so';
    terms = program.args.slice(0, -1);
  });

program
  .command('bd')
  .description('Search With www.baidu.com')
  .action(function(){
    searchEngine = 'baidu';
    terms = program.args.slice(0, -1);
  });

//parse argvs with commander
program.parse(process.argv);

program.on('--help', function(){
  console.log('');
	console.log('gogl ~ ' + require('../package.json').version.green);
	console.log('Search with google tools in command line'.grey);
	console.log('  Examples:'.yellow);
	console.log('  $ '.cyan + 'gogl word');
	console.log('  $ '.cyan + 'gogl world peace');
  console.log('  $ '.cyan + 'gogl -e [so, baidu, google] worlds');
  console.log('  $ '.cyan + 'gogl so worlds');
  console.log('  $ '.cyan + 'gogl bd worlds');
	console.log('');
});


if (!process.argv[2]) {
  program.emit('--help');
  return;
}

if(program.engine) {
  searchEngine = program.engine;
  terms = program.args;
}

terms || (terms = process.argv.slice(2));

if(gogl[searchEngine]) {
  console.log('');
  console.log(' Search With '.yellow + searchEngine.blue);
  gogl[searchEngine](terms.join('+'));

} else {

  console.log('Unkonw Search Engine.'.red + searchEngine);
  program.emit('--help');
}